R := inputfromfile(sales)
R
R1 := select(R, (time > 50) and (qty < 30))
R1
R8 := select(R, time > 50)
R8
R9 := select(R, pricerange = "outrageous")
R9
R2 := project(R1, saleid, qty, customerid, pricerange)
R2
R3 := avg(R1, qty)
R3
R4 := sumgroup(R1, time, qty)
R4
R5 := sumgroup(R1, qty, time, pricerange)
R5
R6 := avggroup(R1, qty, pricerange)
R6
S := inputfromfile(sales2)
S
T := join(R, S, R.saleid = S.C)
T
T1 := join(R1, S, R1.qty <= S.Q)
T1
T2 := sort(T1, S_C)
T2
T2prime := sort(T1, R1_time, S_C)
T2prime
T3 := movavg(T2, R1_qty, 3)
T3
T4 := movsum(T2, R1_qty, 5)
T4
Q1 := select(S, saleid = 93086)
Q1
Btree(S, saleid)
S
Q2 := select(S, saleid = 93086)
Q2
Q3 := select(S, Q > 20)
Q3
Hash(S, saleid)
S
Q5 := concat(Q2, Q3)
Q5
outputtofile(Q5, bar)

