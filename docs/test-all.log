/Users/nxt/Applications/miniconda3/envs/env_py36/bin/python /Users/nxt/Documents/Project/db-sample/main.py

[1] pd >> R := inputfromfile(sales1.txt)
 saleid        itemid        customerid    storeid       time          qty           pricerange
 36            14            2             38            49            15            3
 784           90            182           97            46            31            3
[1000 rows and 7 columns]
total time: 0.002730131149291992

[2] pd >> S := inputfromfile(sales2.txt)
 saleid        itemid        customerid    storeid       time          qty           pricerange
 3506          13517         16566         45            73            19            4
 78345         10528         4745          20            73            23            1
[100000 rows and 7 columns]
total time: 0.24036812782287598

[3] pd >> R1 := select(R, qty < 30)
 saleid        itemid        customerid    storeid       time          qty           pricerange
 36            14            2             38            49            15            3
 801           117           2             43            81            14            5
[585 rows and 7 columns]
total time: 0.00039887428283691406

[4] pd >> R3 := avg(R1, qty)
 avg(qty)
 14.805128205128206
[1 rows and 1 columns]
total time: 0.00010895729064941406

[5] pd >> R4 := sumgroup(R1, time, qty,pricerange)
 qty           pricerange    sum
 15            3             200
 14            5             789
[124 rows and 3 columns]
total time: 0.0008649826049804688

[6] pd >> R6 := avggroup(R1, time, qty,pricerange)
 qty           pricerange    avg
 15            3             66.66666666666667
 14            5             60.69230769230769
[124 rows and 3 columns]
total time: 0.0009751319885253906

[7] pd >> T := join(R, S, R.saleid = S.saleid)
 R_saleid      R_itemid      R_customerid  R_storeid     R_time        R_qty         R_pricerange  S_saleid      S_itemid      S_customerid  S_storeid     S_time        S_qty         S_pricerange
 629           134           59            13            98            43            2             629           9494          614           44            73            25            3
 855           132           140           24            67            3             2             855           6016          14782         75            95            36            1
[1000 rows and 14 columns]
total time: 20.543104887008667

[8] pd >> T1 := join(R1, S, R1.qty <= S.qty)
 R1_saleid     R1_itemid     R1_customerid R1_storeid    R1_time       R1_qty        R1_pricerange S_saleid      S_itemid      S_customerid  S_storeid     S_time        S_qty         S_pricerange
 36            14            2             38            49            15            3             3506          13517         16566         45            73            19            4
 801           117           2             43            81            14            5             3506          13517         16566         45            73            19            4
[42349722 rows and 14 columns]
total time: 48.66679096221924

[9] pd >> T5 := sort(T, S_storeid)
 R_saleid      R_itemid      R_customerid  R_storeid     R_time        R_qty         R_pricerange  S_saleid      S_itemid      S_customerid  S_storeid     S_time        S_qty         S_pricerange
 240           88            59            96            67            25            5             240           8198          8802          1             73            42            1
 608           74            174           41            55            43            1             608           7759          8397          1             27            5             1
[1000 rows and 14 columns]
total time: 0.006424903869628906

[10] pd >> T2 := sort(T1, S_storeid)
 R1_saleid     R1_itemid     R1_customerid R1_storeid    R1_time       R1_qty        R1_pricerange S_saleid      S_itemid      S_customerid  S_storeid     S_time        S_qty         S_pricerange
 36            14            2             38            49            15            3             58541         8123          5746          1             72            48            1
 801           117           2             43            81            14            5             58541         8123          5746          1             72            48            1
[42349722 rows and 14 columns]
total time: 212.20054697990417

[11] pd >> T3 := movavg(T2, R1_qty, 3)
 R1_saleid     R1_itemid     R1_customerid R1_storeid    R1_time       movavg(R1_qty)R1_pricerange S_saleid      S_itemid      S_customerid  S_storeid     S_time        S_qty         S_pricerange
 36            14            2             38            49            15.0          3             58541         8123          5746          1             72            48            1
 801           117           2             43            81            14.5          5             58541         8123          5746          1             72            48            1
[42349722 rows and 14 columns]
total time: 535.496787071228

[12] pd >> T4 := movsum(T, R_qty, 5)
 R_saleid      R_itemid      R_customerid  R_storeid     R_time        movavg(R_qty) R_pricerange  S_saleid      S_itemid      S_customerid  S_storeid     S_time        S_qty         S_pricerange
 629           134           59            13            98            43            2             629           9494          614           44            73            25            3
 855           132           140           24            67            46            2             855           6016          14782         75            95            36            1
[1000 rows and 14 columns]
total time: 0.019697904586791992

[13] pd >> Q1 := select(S, saleid = 93086)
 saleid        itemid        customerid    storeid       time          qty           pricerange
 93086         8436          2718          30            73            50            1
[1 rows and 7 columns]
total time: 0.05850100517272949

[14] pd >> Btree(S, saleid)
total time: 0.3779318332672119

[15] pd >> Q2 := select(S, saleid = 93086)
 saleid        itemid        customerid    storeid       time          qty           pricerange
 93086         8436          2718          30            73            50            1
[1 rows and 7 columns]
total time: 0.00020313262939453125

[16] pd >> Q3 := select(S, qty > 20)
 saleid        itemid        customerid    storeid       time          qty           pricerange
 78345         10528         4745          20            73            23            1
 79991         6715          707           75            41            34            4
[60108 rows and 7 columns]
total time: 0.03265190124511719

[17] pd >> Hash(S, saleid)
total time: 0.0852210521697998

[18] pd >> Q5 := concat(Q2, Q3)
 saleid        itemid        customerid    storeid       time          qty           pricerange
 93086         8436          2718          30            73            50            1
 78345         10528         4745          20            73            23            1
[60109 rows and 7 columns]
total time: 0.0038912296295166016

[19] pd >> outputtofile(Q5, bar)
total time: 0.08197569847106934

Process finished with exit code 0
